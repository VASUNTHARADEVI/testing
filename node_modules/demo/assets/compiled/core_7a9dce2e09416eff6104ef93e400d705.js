YUI.add("mojito-analytics-addon",function(a,b){function d(b,d,e){this.ac=e,this[c]={},this.mergeFunction=a.mojito.util.metaMerge}var c="analytics";d.prototype={namespace:"analytics",setMergeFunction:function(a){this.mergeFunction=a},store:function(a){this[c]=this.mergeFunction(this[c],a),this.ac.meta.store(c,this[c])},retrieve:function(a,b){this.ac.meta.retrieve(function(b){a.call(this,b[c])},b)}},d.dependsOn=["meta"],a.mojito.addons.ac.analytics=d},"0.1.0",{requires:["mojito-util","mojito-meta-addon"]}),YUI.add("mojito-assets-addon",function(a,b){function d(a,b,c){this.assetsRoot=a.instance.assetsRoot,this.assets={},this.added={},this.mojitType=a.instance.type,this.context=a.context,a.instance&&a.instance.config&&a.instance.config.assets&&this.addAssets(a.instance.config.assets)}var c=function(a){return YUI._mojito._cache&&YUI._mojito._cache.compiled&&YUI._mojito._cache.compiled.css&&YUI._mojito._cache.compiled.css.inline&&YUI._mojito._cache.compiled.css.inline[a]};d.prototype={namespace:"assets",addCss:function(a,b){this.addAsset("css",b||"top",a)},addJs:function(a,b){this.addAsset("js",b||"bottom",a)},addBlob:function(a,b){this.addAsset("blob",b||"bottom",a)},addAsset:function(a,b,d){if(!d)return;d.indexOf("./")===0&&(d=this.getUrl(d.slice(2)));if(this.added[d])return;this.added[d]=!0;if("css"===a&&c(d)){if("client"===this.context.runtime){YUI._mojito._cache.compiled.css.inline.added||(YUI._mojito._cache.compiled.css.inline.added={});if(YUI._mojito._cache.compiled.css.inline.added[d])return;YUI._mojito._cache.compiled.css.inline.added[d]=!0}a="blob",d='<style type="text/css">\n'+YUI._mojito._cache.compiled.css.inline[d]+"</style>\n";if(this.added[d])return}this.assets[b]||(this.assets[b]={}),this.assets[b][a]||(this.assets[b][a]=[]),this.assets[b][a].push(d)},addAssets:function(a){var b,c,d;for(b in a)if(a.hasOwnProperty(b))for(c in a[b])if(a[b].hasOwnProperty(c))for(d in a[b][c])a[b][c].hasOwnProperty(d)&&this.addAsset(c,b,a[b][c][d])},preLoadImage:function(a){var b;typeof document!="undefined"&&(b=new Image,b.src=a)},preLoadImages:function(a){var b;for(b in a)a.hasOwnProperty(b)&&this.preLoadImage(a[b])},getUrl:function(a){return this.assetsRoot+"/"+a},mixAssets:function(b,c){return a.mojito.util.metaMerge(b,c)},getAssets:function(){return this.assets},mergeMetaInto:function(a){this.mixAssets(a.assets,this.assets)}},a.mojito.addons.ac.assets=d},"0.1.0",{requires:["mojito-util"]}),YUI.add("mojito-composite-addon",function(a,b){function c(a,b,c){this.buffer=a,this.id=b,this.callback=c,this.__meta=[]}function d(a,b,c){this.command=a,this.dispatch=c._dispatch,this.ac=c,this.adapter=b}c.prototype={done:function(a,b){this.buffer[this.id].meta=b,this.buffer[this.id].data+=a,this.buffer.__counter__-=1,this.buffer.__counter__===0&&this.callback()},flush:function(a,b){this.buffer[this.id].meta=b,this.buffer[this.id].data+=a},error:function(c){a.log("Error executing child mojit at '"+this.id+"':","error",b),c.message?a.log(c.message,"error",b):a.log(c,"error",b),c.stack&&a.log(c.stack,"error",b),this.done("")}},d.prototype={namespace:"composite",done:function(b){var c,d=this.ac,e=this.command.instance.config,f=e.children;b=b||{},c=b.template||{};if(!f||a.Object.size(f)===0)throw new Error("Cannot run composite mojit children because there are no children defined in the composite mojit spec.");this.execute(e,function(b,e){var f=a.merge(c,b);d.done(f,e)},this)},execute:function(b,c){var d=this.ac,e={},f={},g={};b.children=b.children||{};if(a.Lang.isArray(b.children))throw new Error("Cannot process children in the format of an array. 'children' must be an object.");g.children=b.children,e.__counter__=a.Object.size(b.children),this._dispatchChildren(b.children,this.command,e,function(){var h;for(h in e)e.hasOwnProperty(h)&&h!=="__counter__"&&(f[h]=e[h].data||"",e[h].meta&&(g=a.mojito.util.metaMerge(g,e[h].meta)));b.assets&&(g.assets||(g.assets={}),d.assets.mixAssets(g.assets,b.assets)),c(f,g)})},_dispatchChildren:function(b,d,e,f){var g,h,i,j;a.Object.each(b,function(c,d){if(c.defer){if(a.Lang.isObject(c.proxy))throw new Error("Cannot specify a child mojit spec with both 'defer' and 'proxy' configurations, because 'defer' assumes a 'proxy' to the LazyLoad mojit.");c.proxy={type:"LazyLoad"}}a.Lang.isObject(c.proxy)&&(b[d]=c.proxy,delete c.proxy,b[d].config||(b[d].config={}),c.proxy=undefined,c.defer=!1,b[d].config.proxied=c)});for(g in b)b.hasOwnProperty(g)&&(h=b[g],e[g]={name:g,data:"",meta:{}},j={instance:h,action:h.action||"index",context:d.context,params:h.params||d.params},i=new c(e,g,f),i=a.mix(i,this.adapter),this.dispatch(j,i))}},a.mojito.addons.ac.composite=d},"0.1.0",{requires:["mojito-util","mojito-params-addon"]}),YUI.add("mojito-config-addon",function(a,b){function c(a,b,c){if(!b)return a||{};var d=b.split("."),e=a,f;for(f=0;f<d.length;f+=1){if(!e[d[f]])return c;e=e[d[f]]}return e}function d(a,b,c){this._config=a.instance.config,this._def=a.instance.definition}d.prototype={namespace:"config",get:function(a,b){return c(this._config,a,b)},getDefinition:function(a,b){return c(this._def,a,b)}},a.mojito.addons.ac.config=d},"0.1.0",{requires:["mojito"]}),YUI.add("mojito-cookie-addon",function(a,b){function c(b,c,d){var e=["exists","get","getSub","getSubs","remove","removeSub","set","setSub","setSubs"];a.Array.each(e,function(b){this[b]=function(){return a.Cookie[b].apply(a.Cookie,arguments)}},this)}c.prototype={namespace:"cookie"},a.mojito.addons.ac.cookie=c},"0.1.0",{requires:["cookie","mojito"]}),YUI.add("mojito-i13n-addon",function(a,b){function c(a,b,c){var d,e,f;if(this.initialized)return;d=a.instance.config.i13n||null;if(d){this.initialized=!0;if(typeof d.spaceid=="number"||typeof d.spaceid=="string"){c.stamp.stampPageView(d.spaceid);if(typeof d.page=="object"){e=d.page;for(f in e)e.hasOwnProperty(f)&&c.trackPageParams(f,e[f],c.ULT.ULT_PRECEDENCE_DEFAULT)}}}}function d(a,b,e){var f;this._ac=e,this.command=a;if(e.http){f=e.http.getRequest();if(f&&f.i13n){e.i13n=f.i13n,e.i13n.make=d.prototype.make,e.i13n._ac=e,c.call(this,a,e,f.i13n);return}}e.i13n=this}d.prototype={make:function(a,b,c,d,e,f){var g=this._ac.url.make(a,b,c,d,e);return g&&(g=this.trackLink(g,f)),g},stampPageView:function(a){},trackPageParams:function(a,b){},trackLink:function(a,b,c,d){},trackUserLink:function(a,b,c,d){},trackForm:function(a,b,c,d){},trackClickOnly:function(a,b,c){},getSpaceid:function(){},stampNonClassified:function(){},stampIgnore:function(){},isStamped:function(){}},d.dependsOn=["config","http","url"],a.mojito.addons.ac.i13n=d},"0.1.0",{requires:["mojito"]}),YUI.add("mojito-intl-addon",function(a,b){function c(a,b,c){this.ac=c}c.prototype={namespace:"intl",lang:function(b,c){a.Intl.setLang(this.ac.type,this.ac.context.lang);var d=a.Intl.get(this.ac.type,b);return d&&c?a.Lang.sub(d,a.Lang.isString(c)?[c]:c):d},formatDate:function(b){return a.DataType.Date.format(b,{format:"%x"})}},c.dependsOn=["config"],a.mojito.addons.ac.intl=c},"0.1.0",{requires:["intl","datatype-date","mojito","mojito-config-addon"]}),YUI.add("mojito-meta-addon",function(a,b){function d(a,b,d){this[c]={}}var c="common";d.prototype={namespace:"meta",store:function(a,b){this[c][a]=b},retrieve:function(a,b){this._callback=a,this._cbScope=b},mergeMetaInto:function(b){var d=this._cbScope||this;return b[c]?b[c]=a.mojito.util.metaMerge(b[c],this[c]):b[c]=this[c],this._callback&&this._callback.call(d,b[c]),b}},d.dependsOn=["core"],a.mojito.addons.ac.meta=d},"0.1.0",{requires:["mojito-util","mojito-output-adapter-addon"]}),YUI.add("mojito-output-adapter-addon",function(a,b){function m(a,b,c){c.flush=d,c.done=e,c.error=f}var c='charset="utf-8"',d,e,f,g,h,i,j,k,l;d=function(a,b){return this.done(a,b,!0)},e=function(d,e,f){var h=f?"flush":"done",i=this.command.instance,m=this._adapter,n=this.command.action,o,p=null,q,r;a.Lang.isString(e)&&(g[e]?e={serialize:e}:e={view:{name:e}}),e=e||{},e.assets=e.assets||{},e.assets.bottom=e.assets.bottom||{},e.assets.bottom.js=e.assets.bottom.js||[],e.http=e.http||{},e.http.code=e.http.code||200,e.http.headers=e.http.headers||{},e.view=e.view||{},e.view.cacheTemplates=!0,this.app&&this.app.config&&this.app.config.cacheViewTemplates&&(e.view.cacheTemplates=this.app.config.cacheViewTemplates||!1),e.serialize&&g[e.serialize]&&(d=g[e.serialize].apply(this,[d,e]),delete e.serialize),e.view.name=e.view.name||n,e.view.binder=e.view.binder||e.view.name,o=i.views[e.view.name],e.view.id||(e.view.id=a.guid()),o&&e.view["content-path"]&&(o["content-path"]=e.view["content-path"]),o&&e.view.engine&&(o.engine=e.view.engine),a.Object.each(this,function(b){b&&a.Lang.isFunction(b.mergeMetaInto)&&b.mergeMetaInto(e)}),q=e.http.headers["content-type"],l(e.children,e.binders),e.binders||(e.binders={}),e.binders[e.view.id]||(e.binders[e.view.id]={base:i.base,action:n,config:j(i.config),type:i.type,viewId:e.view.id,guid:i.instanceId,instanceId:i.instanceId,children:k(e.children)});if(a.Lang.isString(d)){q||(e.http.headers["content-type"]=["text/plain; "+c]),m[h](d,e),a.log("dispatch complete for "+i.instanceId,"mojito","qeperf");return}if(o)d=d||{},e.binders[e.view.id]&&(e.binders[e.view.id].name=o["binder-module"],e.binders[e.view.id].needs=o["binder-yui-sorted"]),q||(e.http.headers["content-type"]=["text/html; "+c]),d.mojit_guid=i.instanceId,d.mojit_view_id=e.view.id,d.mojit_assets=this.command.instance.assetsRoot,a.log('Rendering "'+e.view.name+'" view for "'+(i.id||"@"+i.type)+'"',"info",b),r=o["content-path"],this.app.config.pathToRoot&&(r=this.app.config.pathToRoot+r),p=new a.mojito.ViewRenderer(o.engine,e.view.id),p.render(d,i.type,r,m,e,f);else{if(a.Lang.isObject(d))throw new Error("Missing view template: '"+e.view.name+"'");m[h](d,e)}a.mojito.perf.mark("mojito","core_action_end["+i.type+":"+n+"]",'ac.done() completed for Mojit "'+i.type+'" with action "'+n+'"')},f=function(a){this._adapter.error(a)},j=function(b){var c;return a.Lang.isObject(b)?(c=a.mojito.util.copy(b),c.children=k(c.children),c):b},k=function(b){return a.Lang.isObject(b)?(a.Object.each(b,function(a,c){delete b[c].params}),b):b},l=function(b,c){if(!b)return;a.Object.each(c,function(c,d){a.Object.each(b,function(a){c.instanceId===a.instanceId&&(a.viewId=d)})})},i=function(b,d){d.http.headers["content-type"]=["application/json; "+c];try{return a.JSON.stringify(b)}catch(e){throw new Error('Expected JSON data, but there was a parse error on the string: "'+b)}},h=function(b,d){function e(a,b){return a instanceof Object?e(Object.keys(a).map(function(b){return e(a[b],b)}).join("\n"),b):(b?"<"+b+">":"")+a+(b?"</"+b+">":"")}d.http.headers["content-type"]=["application/xml; "+c];if(a.Lang.isObject)try{return e(b,"xml")}catch(f){throw new Error('Expected XML data, but there was a parse error on the string: "'+b)}return""},g={json:i,xml:h},a.mojito.addons.ac.core=m},"0.1.0",{requires:["json-stringify","event-custom-base","mojito-view-renderer","mojito-util"]}),YUI.add("mojito-params-addon",function(a,b){function c(a){this.params=a.params||{}}c.prototype={namespace:"params",getAll:function(){return{route:this.getFromRoute(),url:this.getFromUrl(),body:this.getFromBody(),file:{}}},all:function(){return this.getAll.apply(this,arguments)},getFromMerged:function(b){return this._merged||(this._merged=a.merge(this.getFromBody(),this.getFromUrl(),this.getFromRoute())),b?this._merged[b]:this._merged},merged:function(){return this.getFromMerged.apply(this,arguments)},getFromRoute:function(b){return this._route||(this._route=a.merge(this.params.route||{})),b?this._route[b]:this._route},route:function(){return this.getFromRoute.apply(this,arguments)},getFromUrl:function(b){return this._url||(this._url=a.merge(this.params.url||{})),b?this._url[b]:this._url},url:function(){return this.getFromUrl.apply(this,arguments)},getFromBody:function(b){return this._body||(this._body=a.merge(this.params.body||{})),b?this._body[b]:this._body},body:function(){return this.getFromBody.apply(this,arguments)},getFromFiles:function(){throw new Error("The method 'api.params.getFromFiles()' is not implemented yet.")},files:function(){return this.getFromFiles.apply(this,arguments)}},a.mojito.addons.ac.params=c},"0.1.0",{requires:["mojito"]}),YUI.add("mojito-partial-addon",function(a,b){function c(a,b,c){this.command=a,this.dispatch=c._dispatch,this.ac=c,this.adapter=b}c.prototype={namespace:"partial",render:function(c,d,e){var f,g,h=this.command.instance,i={view:{}};if(!h.views[d]){e('View "'+d+'" not found');return}g=h.views[d],c=c||{},f=new a.mojito.ViewRenderer(g.engine),a.log('Rendering "'+d+'" view for "'+(h.id||"@"+h.type)+'"',"debug",b),f.render(c,h.type,g["content-path"],{buffer:"",flush:function(a){this.buffer+=a},done:function(a){this.buffer+=a,e(null,this.buffer)}},i)},invoke:function(b,c,d){var e;"function"==typeof c&&(d=c,c={}),e={instance:{base:this.command.instance.base,type:this.command.instance.type},action:b,context:this.ac.context,params:c.params||this.ac.params.getAll()},this.dispatch(e,{data:"",meta:{},done:function(b,c,e){a.mojito.util.metaMerge(this.meta,c),this.data+=b,delete c.http.headers["content-type"],delete c.view,e||d(null,this.data,this.meta)},flush:function(a,b){this.done(a,b,!0)}})}},a.mojito.addons.ac.partial=c},"0.1.0",{requires:["mojito-util","mojito-params-addon","mojito-view-renderer"]}),YUI.add("mojito-url-addon",function(a,b){function c(b,c){return c&&a.Object.each(b,function(a,c){a||delete b[c]}),a.Lang.isObject(b)&&a.Object.size(b)>0&&(b=a.QueryString.stringify(b)),b}function d(b,c,d){this.maker=new a.mojito.RouteMaker(d.app.routes),this.appConfig=d.app.config}d.prototype={namespace:"url",make:function(b,d,e,f,g){var h,i=b+"."+d;return e=c(e),e&&e.length&&(i=i+"?"+e),h=this.maker.make(i,f),g&&(g=c(g,!0),g&&g.length&&(h=h+"?"+g)),typeof window!="undefined"&&(h=a.mojito.util.iOSUrl(h)),this.appConfig.pathToRoot&&(h=this.appConfig.pathToRoot+h),h},find:function(a,b){return a.indexOf("http://")===0&&(a=a.slice(a.indexOf("/",7))),a.indexOf("?")>0&&(a=a.slice(0,a.indexOf("?"))),this.maker.find(a,b)}},a.mojito.addons.ac.url=d},"0.1.0",{requires:["querystring-stringify-simple","mojito-route-maker","mojito-util"]}),YUI.add("mojito-mu",function(a,b){function g(){}var c={},d={},e,f;f=function(){var a,b=function(){};return b.prototype={otag:"{{",ctag:"}}",pragmas:{},buffer:[],pragmas_implemented:{"IMPLICIT-ITERATOR":!0},context:{},render:function(a,b,c,d){var e;d||(this.context=b,this.buffer=[]);if(!this.includes("",a)){if(d)return a;this.send(a);return}a=this.render_pragmas(a),e=this.render_section(a,b,c);if(d)return this.render_tags(e,b,c,d);this.render_tags(e,b,c,d)},send:function(a){a&&this.buffer.push(a)},render_pragmas:function(a){var b,c;return this.includes("%",a)?(b=this,c=new RegExp(this.otag+"%([\\w-]+) ?([\\w]+=[\\w]+)?"+this.ctag),a.replace(c,function(a,c,d){var e;if(!b.pragmas_implemented[c])throw{message:"This implementation of mustache doesn't understand the "+c+"' pragma"};return b.pragmas[c]={},d&&(e=d.split("="),b.pragmas[c][e[0]]=e[1]),""})):a},render_partial:function(a,b,c){a=this.trim(a);if(!c||c[a]===undefined)throw{message:"unknown_partial '"+a+"'"};return typeof b[a]!="object"?this.render(c[a],b,c,!0):this.render(c[a],b[a],c,!0)},render_section:function(a,b,c){var d,e;return!this.includes("#",a)&&!this.includes("^",a)?a:(d=this,e=new RegExp(this.otag+"(\\^|\\#)\\s*(.+)\\s*"+this.ctag+"\n*([\\s\\S]+?)"+this.otag+"\\/\\s*\\2\\s*"+this.ctag+"\\s*","mg"),a.replace(e,function(a,e,f,g){var h=d.find(f,b);if(e==="^")return!h||d.is_array(h)&&h.length===0?d.render(g,b,c,!0):"";if(e==="#")return d.is_array(h)?d.map(h,function(a){return d.render(g,d.create_context(a),c,!0)}).join(""):d.is_object(h)?d.render(g,d.create_context(h),c,!0):typeof h=="function"?h.call(b,g,function(a){return d.render(a,b,c,!0)}):h?d.render(g,b,c,!0):""}))},render_tags:function(a,b,c,d){var e=this,f=function(){return new RegExp(e.otag+"(=|!|>|\\{|%)?([^\\/#\\^]+?)\\1?"+e.ctag+"+","g")},g=f(),h=function(a,d,h){switch(d){case"!":return"";case"=":return e.set_delimiters(h),g=f(),"";case">":return e.render_partial(h,b,c);case"{":return e.find(h,b);default:return e.escape(e.find(h,b))}},i=a.split("\n"),j;for(j=0;j<i.length;j+=1)i[j]=i[j].replace(g,h,this),d||this.send(i[j]);if(d)return i.join("\n")},set_delimiters:function(a){var b=a.split(" ");this.otag=this.escape_regex(b[0]),this.ctag=this.escape_regex(b[1])},escape_regex:function(b){if(!a){var c=["/",".","*","+","?","|","(",")","[","]","{","}","\\"];a=new RegExp("(\\"+c.join("|\\")+")","g")}return b.replace(a,"\\$1")},find:function(a,b){function d(a){return a===!1||a===0||a}var c;return a=this.trim(a),d(b[a])?c=b[a]:d(this.context[a])&&(c=this.context[a]),typeof c=="function"?c.apply(b):c!==undefined?c:""},includes:function(a,b){return b.indexOf(this.otag+a)!==-1},escape:function(a){return a=String(a===null?"":a),a.replace(/&(?!\w+;)|["'<>\\]/g,function(a){switch(a){case"&":return"&amp;";case"\\":return"\\\\";case'"':return"&quot;";case"'":return"&#39;";case"<":return"&lt;";case">":return"&gt;";default:return a}})},create_context:function(a){var b,c;return this.is_object(a)?a:(b=".",this.pragmas["IMPLICIT-ITERATOR"]&&(b=this.pragmas["IMPLICIT-ITERATOR"].iterator),c={},c[b]=a,c)},is_object:function(a){return a&&typeof a=="object"},is_array:function(a){return Object.prototype.toString.call(a)==="[object Array]"},trim:function(a){return a.replace(/^\s*|\s*$/g,"")},map:function(a,b){var c,d,e;if(typeof a.map=="function")return a.map(b);c=[],d=a.length;for(e=0;e<d;e+=1)c.push(b(a[e]));return c}},{name:"mustache.js",version:"0.3.1-dev",to_html:function(a,c,d,e){var f=new b;e&&(f.send=e),f.render(a,c,d);if(!e)return f.buffer.join("\n")}}}(),g.prototype.render=function(g,h,i,j,k,l){var m,n=!0,o,p=h.replace(/\./g,"_");m=function(a,b){var e,g,h=[],j,k,l,m;c[i]=b.responseText,h=d[i].splice(0),delete d[i];for(e=0,g=h.length;e<g;e+=1)j=h[e].adapter,k=h[e].more,l=h[e].data,m=h[e].meta,k?j.flush(f.to_html(b.responseText,l),m):j.done(f.to_html(b.responseText,l),m)},k&&k.view&&k.view["content-path"]&&(n=!1),o={data:g,adapter:j,meta:k,more:l};if(!!d[i]){d[i].push(o);return}d[i]=[o];if(n&&e(k,p)){a.log('Using a compiled view for file "'+i+'"',"mojito",b),m(null,{responseText:YUI._mojito._cache.compiled[p].views[k.view.name]});return}typeof window!="undefined"&&(i=a.mojito.util.iOSUrl(i)),c[i]?m(null,{responseText:c[i]}):a.io(i,{on:{complete:m}})},e=function(a,b){return a&&a.view&&a.view.name&&YUI._mojito._cache&&YUI._mojito._cache.compiled&&YUI._mojito._cache.compiled[b]&&YUI._mojito._cache.compiled[b].views&&YUI._mojito._cache.compiled[b].views[a.view.name]},a.mojito.addons.viewEngines.mu=g},"0.1.0",{requires:["mojito-util","io-base"]}),YUI.add("mojito-action-context",function(a,b){function d(b,c,e){var f,g=b.dependsOn,h;if(!a.Lang.isArray(g))return;for(h=0;h<g.length;h+=1){f=g[h];if(!e[f]){if(!c[f])throw new Error(b.prototype.namespace+" addon has invalid dependency: '"+f+"'");d(c[f],c,e)}e[f]=!0}}function e(a,b,e,f){var g,h,i={};if(c[f.type])i=c[f.type];else{for(g in a)a.hasOwnProperty(g)&&(i[g]||d(a[g],a,i),i[g]=!0);c[f.type]=i}for(g in i)i.hasOwnProperty(g)&&(h=new a[g](b,e,f),h.namespace&&(f[h.namespace]=h))}function f(c){a.log("constructing action context","mojito","qeperf");var d=this,f=c.command,g=f.instance,h=c.controller,i=c.models,j=c.dispatch,k=c.adapter,l=c.store,m,n;if(f.action==="init")throw new Error("Cannot execute action 'init' on any mojit. This name is reserved by the Mojito framework.");this.command=f,this.instance=g,this.action=f.action,this.type=g.type,this.context=f.context,this.models=i,this._dispatch=j,this._adapter=k,this.dispatch=function(){a.log("ac.dispatch() will soon be deprecated to discourage usage from within controllers. If you want to dispatch a command from within an ActionContext addon, please use ac._dispatch().","warn",b),d._dispatch.apply(d,arguments)},this.app={config:l.getAppConfig(this.context,"definition"),routes:l.getRoutes(this.context)},e(a.mojito.addons.ac,f,k,this),this.deploy&&this.deploy.setStore(l),a.log('ActionContext created for "'+(g.id||"@"+g.type)+"/"+f.action+'"',"mojito",b),m=f.action;if(!a.Lang.isFunction(h[m])){if(!a.Lang.isFunction(h.__call))throw n=new Error("No method '"+f.action+"' on controller type '"+g.type+"'"),n.code=404,n;m="__call"}a.mojito.perf.mark("mojito","core_action_start["+g.type+":"+f.action+"]",'Calling the Mojit "'+g.type+'" with action "'+f.action+'"'),a.log('action context created, executing action "'+m+'"',"mojito","qeperf"),h[m](this)}var c;YUI._mojito||(YUI._mojito={}),YUI._mojito._cache||(YUI._mojito._cache={}),YUI._mojito._cache.addons||(YUI._mojito._cache.addons={}),c=YUI._mojito._cache.addons,a.mojito.ActionContext=f},"0.1.0",{requires:["mojito-config-addon","mojito-output-adapter-addon","mojito-url-addon","mojito-assets-addon","mojito-cookie-addon","mojito-params-addon","mojito-composite-addon"]}),YUI.add("mojito-controller-context",function(a,b){function c(a){this.instance=a.instance,this.dispatch=a.dispatch,this.store=a.store,this.Y=a.Y,this.shareYUIInstance=a.appShareYUIInstance&&this.instance.shareYUIInstance,this.init()}c.prototype={init:function(){var c,d=this.instance,e,f=this.shareYUIInstance,g=this.store.getAppConfig({},"definition").config,h=a.merge(g,d.config),i=this.Y.mojito.controller||this.Y.mojito.controllers[d.controllerModuleName];if(!a.Lang.isObject(i))throw c=new Error("Mojit controller prototype is not an object! (mojit id: '"+d.id+"')"),c.code=404,c;e=this.controller=a.mojito.util.heir(i),a.Lang.isFunction(e.init)&&e.init(h),a.Object.each(this.Y.mojito.actions,function(a,c){this.Y.log("mixing action '"+c+"' into controller...","debug",b),e[c]=function(){a.apply(e,arguments)}}),this.models={},a.Object.each(this.Y.mojito.models,function(b,c){if(!f||d.modelYUIModuleNames&&d.modelYUIModuleNames[c]){var e=a.mojito.util.heir(b);a.Lang.isFunction(e.init)&&e.init(h),this.models[c]=e}},this)},invoke:function(a,c){this.Y.log("controller context invoke() for "+this.instance.instanceId,"mojito","qeperf");var d=this.instance,e=a.instance.config,f=a.action,g;a.instance=d,a.instance.config=e,a.action||(a.action=d.action||"index");try{g=new this.Y.mojito.ActionContext({command:a,controller:this.controller,models:this.models,dispatch:this.dispatch,adapter:c,store:this.store})}catch(h){c.error?c.error(h):(this.Y.log("WARNING!! Uncaught error from dispatch on instance '"+(d.id||"@"+d.type)+"'","error",b),this.Y.log(h.message,"error",b),this.Y.log(h.stack,"error",b))}this.Y.mojito.perf.mark("mojito","core_dispatch_end["+(d.id||"@"+d.type)+":"+f+"]")}},a.mojito.ControllerContext=c},"0.1.0",{requires:["mojito-action-context","mojito-util"]}),YUI.add("mojito-dispatcher",function(a,b){function l(b,c,d){var e=[],f={},g=a.Intl.lookupBestLang(c,a.Object.keys(d.yui.langs)),h=g?"_"+g:"",i={},j,k;!g&&!d.yui.langs[""]&&(d.yui.langs.en&&(g="en",h="_en"),!g&&d.yui.langs["en-US"]&&(g="en-US",h="_en-US")),i["lang/"+b+h]=!0,h?i["lang/datatype-date-format"+h]=!0:i["lang/datatype-date-format_en"]=!0,a.Array.each(d.yui.sorted,function(a){"lang/"===a.substring(0,5)?i[a]&&e.push(a):e.push(a)}),a.Object.each(d.yui.sortedPaths,function(a,b){"lang/"===b.substring(0,5)?i[b]&&(f[b]=a):f[b]=a}),d.yui.sorted=e,d.yui.sortedPaths=f}function m(n,o){d.log("dispatching command for "+(n.instance.base||"@"+n.instance.type)+"."+n.action,"mojito","qeperf");var p=n.instance,q=g?f.controllerContexts[p.instanceId]:null;if(q){d.log("using cached controller context: "+p.instanceId,"info",b),q.invoke(n,o);return}d.log("expanding partial mojit instance","mojito","qeperf"),e.expandInstance(n.instance,n.context,function(p,r){function v(){var c,h;l(n.instance.type,n.context.lang,r),c=i?r.yui.sorted:r.yui.requires,h=a.mojito.util.copy(c),d.log("Dispatching an instance of '"+(r.id||"@"+r.type)+"/"+n.action+"' with the modules: ["+h.join(", ")+"]","info",b),d.log("dispatching instance of '"+r.instanceId+"/"+n.action+"'","mojito","qeperf"),h.push(function(c){d.log("YUI used: "+r.instanceId,"mojito","qeperf"),d.log("Creating controller context","info",b),q=new a.mojito.ControllerContext({instance:r,Y:c,store:e,appShareYUIInstance:k,dispatch:m}),d.log("caching controller context: "+r.instanceId,"info",b),g&&(f.controllerContexts[r.instanceId]=q),q.invoke(n,o)}),a.mojito.perf.mark("mojito","core_dispatch_start["+(r.id||"@"+r.type)+":"+n.action+"]","Dispatching an instance of '"+(r.id||"@"+r.type)+"/"+n.action+"'"),d.log("YUI use: "+r.instanceId,"mojito","qeperf"),t.use.apply(t,h)}function w(a){var c={},e="mojit-"+r.type,g;t=f.YUI[s],t?d.log("Using cached YUI instance from key:"+s,"mojito","qeperf"):(g={bootstrap:j,lang:n.context.langs,core:h},t=f.YUI[s]=YUI(g),d.log("YUI instance created: "+r.instanceId,"mojito","qeperf"),d.log("Cached a YUI instance with key: '"+s+"'","mojito",b)),c[e]=r.yui.config,t.applyConfig({groups:c}),a()}n.action||(n.action=r.action||"index");var s,t,u;if(p){o.error?o.error(p):(d.log("WARNING!! Uncaught error from dispatch on instance '"+(n.instance.id||"@"+n.instance.type)+"'","error",b),d.log(p.message,"error",b),d.log(p.stack,"error",b));return}d.log("mojit instance expansion complete: "+r.instanceId,"mojito","qeperf"),n.instance=r;if(k&&r.shareYUIInstance)s="singleton";else{s=[];for(u in n.context)n.context.hasOwnProperty(u)&&n.context[u]&&s.push(u+"="+n.context[u]);s=r.type+"?"+s.join("&")}if(!k||!r.shareYUIInstance)t=f.YUI[s];t?v():i?(d.log("loading YUI modules for YUI instantiation: "+r.instanceId,"mojito","qeperf"),c.load(r.yui.sortedPaths,function(a){if(a){d.log(a.message,"error",b),o.error(a);return}w(v)})):w(v)})}var c,d,e,f={YUI:{},controllerContexts:{}},g=typeof window!="undefined",h=[],i,j,k;a.mojito.Dispatcher={init:function(a,f,g,l){var m;if(!a)throw new Error("Mojito cannot instantiate without a resource store");return e=a,h=f||[],d=g,c=l,d.log("Dispatcher created","debug",b),m=e.getAppConfig({},"definition"),k=!1!==m.shareYUIInstance,i=m.yui&&-1!==m.yui.dependencyCalculations.indexOf("precomputed"),j=m.yui&&-1!==m.yui.dependencyCalculations.indexOf("ondemand"),i||(j=!0),j&&h.push("loader"),this},dispatch:m}},"0.1.0",{requires:["mojito-controller-context","mojito-util","mojito-resource-store-adapter","intl"]}),YUI.add("mojito-loader",function(a,b){function d(a,b){this.appConfig=a,this.prefix=b||""}var c=2e3;d.prototype={load:function(c,d){var e=this,f,g,h={},i=0;c=c||{};if(!a.Object.size(c)){d(null);return}for(f in c)c.hasOwnProperty(f)&&(YUI.Env.mods[f]||(g=c[f],/\.js$/i.test(g)&&("/"===g.charAt(0)&&(g=this.prefix+g),h[g]=!0)));h=a.Object.keys(h);if(!h.length)return d(null);a.log("loading "+h.join(", "),"mojito",b),a.Get.script(h,{async:!0,onSuccess:function(){var c=!1;typeof window!="undefined"?c=!0:(i+=1,i===h.length&&(c=!0)),c&&(a.log("SUCCESS","mojito",b),d(null))},onFailure:function(){a.log("FAILURE","warn",b);var c=new Error("Failed to load URLs:  "+h.join(", "));d(c)}})},_createURLlist:function(a,b){var d,e=[],f,g;if(!b.length)return[];d=a+b.shift();while(b.length)f=b.shift(),g=d.length+1+f.length,g>c?(e.push(d),d=a+f):d+="&"+f;return e.push(d),e},createYuiLibComboUrl:function(b,c){var d={},e=[],f=[],g,h,i,j,k,l,m,n={js:[],css:[]};c=c||"min",g=new a.Loader({});for(j=0;j<b.length;j+=1)k=b[j],d[k]=!0;g.ignoreRegistered=!0,g.calculate({required:d}),Object.keys(g.moduleInfo).forEach(function(a){var b=g.moduleInfo[a];YUI.Env._renderedMods[a]=b}),h=g.FILTER_DEFS[c.toUpperCase()],h&&(i=new RegExp(h.searchExp));for(j=0;j<g.sorted.length;j+=1)k=g.sorted[j],"parallel"!==k&&k.indexOf("nodejs")===-1&&(l=g.moduleInfo[k],l&&(m=h?l.path.replace(i,h.replaceStr):l.path,"lang/datatype-date"===k&&(m="datatype/lang/datatype-date.js"),"js"===l.type?e.push(g.root+m):"css"===l.type&&f.push(g.root+m)));return n.js=this._createURLlist(g.comboBase,e),n.css=this._createURLlist(g.comboBase,f),n}},a.mojito.Loader=d},"0.1.0",{requires:["get","mojito"]}),YUI.add("mojito-logger",function(a,b){function g(b,c){var d=0,g,h;this._opts=a.merge(f,b),this._buffer=[],c&&(this._id=c),g=this._opts.order||[],h=this._opts.level.toLowerCase();for(d=0;d<g.length;d+=1)this._opts.filter[g[d]]=!0;d=0;while(d<=g.length){if(!g[d]||g[d].toLowerCase()===h)break;this._opts.filter[g[d]]=!1,d+=1}d===g.length&&(e=!0),this._opts.filter.DEBUG&&(YUI._mojito||(YUI._mojito={}),YUI._mojito.DEBUG=!0)}var c=/^yui/,d="info",e=!1,f={writer:null,formatter:null,timestamp:!0,level:d,defaultLevel:"info",yui:!1,buffer:!1,maxBufferSize:1024,order:["DEBUG","MOJITO","INFO","WARN","ERROR","NONE"],filter:{DEBUG:!0,MOJITO:!0,INFO:!0,WARN:!0,ERROR:!0,NONE:!0}};f.writer=function(b){var c=0;if(!console||!console.log)return;if(a.Lang.isArray(b))for(c=0;c<b.length;c+=1)console.log(b[c]);else console.log.apply(console,arguments)},f.formatter=function(b,c,d,e,f,g){var h=f.timestamp?"("+e+") ":"",i="",j="";return b instanceof Error?(b.code&&(i=" "+b.code),b.stack&&(j="\n"+b.stack),b="Error"+i+": "+b.message+j):a.Lang.isObject(b)&&(b=JSON.stringify(b,null,2)),d=d?d+": ":"","["+c.toUpperCase()+"] "+h+d+b},g.prototype={log:function(b,d,f){var g,h,i,j;if(e)return;j=(new Date).getTime();if(a.Lang.isObject(b)&&b.flush===!0)return this.flush();g=(d||this._opts.defaultLevel).toLowerCase(),h=c.test(g),i=h?g.split("-").pop():g;if(!this._opts.filter[i.toUpperCase()])return;if(h&&!this._opts.yui)return;this._opts.buffer?(this._buffer.push([b,g,f,j]),a.Object.size(this._buffer)>this._opts.maxBufferSize&&this.flush()):this._publish(b,g,f,j)},flush:function(){var a,b=[];if(this._opts.publisher)this._opts.publisher(this._buffer);else{while(this._buffer.length)a=this._buffer.shift(),b.push(this._opts.formatter(a[0],a[1],a[2],a[3],this._opts,this._id));this._opts.writer(b)}this._buffer=[]},setFormatter:function(a){this._opts.formatter=a},setWriter:function(a){this._opts.writer=a},setPublisher:function(a){console.log("publisher set: "+a.toString()),this._opts.publisher=a},_publish:function(a,b,c,d){this._opts.publisher?this._opts.publisher(a,b,c,d,this._id):this._opts.writer(this._opts.formatter(a,b,c,d,this._opts,this._id))}},a.mojito.Logger=g},"0.1.0",{requires:["mojito"]}),YUI.add("mojito-mojit-proxy",function(a,b){function e(b){this._action=b.action,this._binder=b.binder,this._base=b.base,this._node=b.node,this._element=b.element,this._viewId=b.viewId,this._instanceId=b.instanceId,this._client=b.client,this._store=b.store,this.type=b.type,this.config=b.config,this.context=b.context,a.Array.each(d,function(a){this[a]||(this[a]=function(){throw new Error("Function not implemented: "+a)})},this)}var c="mojit:",d;d=["broadcast","listen","unlisten","closeView","getViewNode","getViewDirection","isViewOpen","navigate","openView","makeRequest","refreshView","setView","abortRequest","error","getContextData","getId","getPref","getService","isRequestPending","setContextData","setPref"],e.prototype={broadcast:function(a,b,d){this._client.doBroadcast(c+a,this._viewId,b,d)},listen:function(a,b){this._client.doListen(c+a,this._viewId,function(a){a.source!==this.id&&b(a)})},unlisten:function(a){var b=a?c+a:null;this._client.doUnlisten(this._viewId,b)},render:function(a,b,c){this._client.doRender(this,a,b,c)},invoke:function(b,c,d){var e,f,g;"function"==typeof c?(e=c,c={}):e=d,"function"!=typeof e&&(e=function(){}),c.params=c.params||{},g={base:this._base,type:this.type,guid:this._instanceId,instanceId:this._instanceId,config:a.mojito.util.copy(this.config)},f={instance:g,action:b,params:{route:c.params.route||{},url:c.params.url||this.getFromUrl(),body:c.params.body||{},file:c.params.file||{}},rpc:c.rpc||!1},this._client.executeAction(f,this.getId(),e)},refreshView:function(b,c){b=b||{},a.Lang.isFunction(b)&&(c=b,b={}),this._client.refreshMojitView(this,b,c)},getFromUrl:function(b){return this.query||(this.query=a.QueryString.parse(window.location.href.split("?").pop())),b?this.query[b]:this.query},getId:function(){return this._viewId},getChildren:function(){return this._client._mojits[this.getId()].children},destroyChild:function(a,b){var c,d,e=this.getChildren(),f=e[a];if(f)d=f.viewId;else for(c in e)e.hasOwnProperty(c)&&e[c].viewId===a&&(d=a);if(!d)throw new Error("Cannot destroy a child mojit with id '"+a+"'. Are you sure this is your child?");this._client.destroyMojitProxy(d,b),f&&(this.config.children&&delete this.config.children[a],delete e[a])},destroyChildren:function(b){var c=this;a.Object.each(this.getChildren(),function(a,d){c.destroyChild(d,b)})},destroySelf:function(a){this._client.destroyMojitProxy(this.getId(),a)},_destroy:function(c){var d=this._binder;a.log("destroying binder "+this._viewId,"debug",b),this.destroyChildren(c),a.Lang.isFunction(d.destroy)&&d.destroy.call(d),c||this._node.remove(!0),this._client.doUnlisten(this._viewId)},_pause:function(){var b=this._binder;a.Lang.isFunction(b.onPause)&&b.onPause()},_resume:function(){var b=this._binder;a.Lang.isFunction(b.onResume)&&b.onResume()}},a.mojito.MojitProxy=e},"0.1.0",{requires:["mojito-util"]}),YUI._mojito||(YUI._mojito={logger:{_logMutatorCache:{publisher:function(){YUI._mojito._clientYlog.apply(YUI._mojito._clientY,arguments)}},set:function(a,b){this._logMutatorCache[a]=b}},_cache:{},_clientY:null,_clientYlog:null}),YUI.add("mojito-client",function(a,b){function g(c,d,e,f){var g,h;if(!c._views||!c._views[e]){f(new Error('View "'+e+'" not found'));return}d=d||{},d.mojit_assets=d.mojit_assets||c._assetsRoot,g=c._views[e],h=new a.mojito.ViewRenderer(g.engine),a.log('Rendering "'+e+'" in Binder',"debug",b),h.render(d,c.type,g["content-path"],{buffer:"",flush:function(a){this.buffer+=a},done:function(a){this.buffer+=a,f(null,this.buffer)}})}function h(c,d){a.log("setting new view on mojit "+d._instanceId,"debug",b);var e=a.Node.create(c);d._node.replace(e),d._element=document.getElementById(d._viewId),d._node=new a.Node(d._element),a.Lang.isFunction(d._binder.onRefreshView)&&d._binder.onRefreshView(d._node,d._element)}function i(a,b){var c,d,e;for(c in a)if(a.hasOwnProperty(c)){for(d in b)b.hasOwnProperty(d)&&!e&&b[d].instanceId===a[c].instanceId&&(a[c].viewId=d,e=!0);e=!1}return a}function j(c,d,e){var f=[];return a.Lang.isFunction(c.bind)&&c.bind(d,e),a.Lang.isFunction(c.handleClick)&&f.push(a.delegate("click",c.handleClick,d,function(){return!0},c)),a.log("Attached "+f.length+" event delegates","debug",b),f}function k(c,d){var e=!1;return a.Lang.isFunction(c.unbind)&&(e=c.unbind.call(c)),d&&a.Array.each(d,function(c){a.log("Detaching event handle from binder","debug",b),c.detach()}),e}function l(b,c){var d;return a.Object.each(b,function(b){a.Object.each(b.children,function(a){if(a.viewId===c)return d=b.proxy,!0});if(d)return!0}),d}function m(a){this.timeLogStack=[],this.yuiConsole=null,this._pauseQueue=[],a&&this.init(a)}function n(a,b){var c=e[a],d;if(!c||!c.length)return;for(d=0;d<c.length;d+=1)c[d](b)}var c=["executeAction","doRender","doBroadcast","doListen","doUnlisten"],d,e,f={PAUSED:"paused",ACTIVE:"active"};YUI._mojito._clientY||(YUI._mojito._clientY=a),d=function(){YUI._mojito.logger&&YUI._mojito.logger.log?YUI._mojito.logger.log.apply(YUI._mojito.logger,arguments):YUI._mojito._clientY.log.apply(YUI._mojito._clientY,arguments)},e={},m.subscribe=function(b,c){if(a&&YUI._mojito._clientY&&a._yuid!==YUI._mojito._clientY._yuid)return;e[b]||(e[b]=[]),e[b].push(c)},m.prototype={init:function(b){n("pre-init",{config:b}),a.mojito.perf.mark("mojito","core_client_start");var e=this,g={},h=b.appConfig;if(h&&h.yui&&h.yui.showConsoleInClient&&!e.yuiConsole){YUI().use("console-filters",function(a){a.one("body").addClass("yui3-skin-sam"),e.yuiConsole=new a.Console({plugins:[a.Plugin.ConsoleFilters],logSource:a.Global,height:600}),e.yuiConsole.render(),e.init(b)});return}h&&h.log&&h.log.client&&(g=h.log.client),a.Array.each(["formatter","writer","publisher"],function(a){YUI._mojito.logger._logMutatorCache[a]&&(g[a]=YUI._mojito.logger._logMutatorCache[a])}),YUI._mojito.logger.log||(YUI._mojito.logger=new a.mojito.Logger(g)),YUI._mojito.loader||(YUI._mojito.loader=new a.mojito.Loader(h,b.pathToRoot)),YUI._mojito._clientYlog||(YUI._mojito._clientYlog=a.log),a.log=d,a.mojito.TunnelClient&&(this.tunnel=new a.mojito.TunnelClient(b.appConfig)),this.resourceStore=new a.mojito.ResourceStore(b),this.resourceStore=a.mojito.ResourceStoreAdapter.init("client",this.resourceStore,YUI._mojito.logger),this.dispatcher=a.mojito.Dispatcher.init(this.resourceStore,null,YUI._mojito.logger,YUI._mojito.loader),this.context=b.context,this.config=b,this._listeners={},this._mojits={},a.mojito.perf.mark("mojito","core_client_end","Mojito client library loaded"),this.attachBinders(b.binderMap),a.Array.each(c,function(a){var b=this,c=b[a];this[a]=function(){b._state===f.PAUSED?b._pauseQueue.push({fn:c,args:arguments}):c.apply(b,arguments)}},this),this._state=f.ACTIVE,n("post-init",{})},attachBinders:function(c,d,e){var g=this.context,h=this,k=[],l,m,o=a.Object.size(c),p=0,q,r=this.resourceStore,s={binderMap:c,parentId:d,topLevelMojitViewId:e};n("pre-attach-binders",s),this.pause(),c=s.binderMap,d=s.parentId,e=s.topLevelMojitViewId,a.mojito.perf.mark("mojito","core_binders_start");if(!o){a.mojito.perf.mark("mojito","core_binders_resume"),h.resume(),a.mojito.perf.mark("mojito","core_binders_end"),n("post-attach-binders",{});return}q=function(){p+=1;if(p<o)return;a.Array.each(k,function(a){var b=a.proxy,c=a.children;h._mojits[b._viewId]={proxy:b,children:c}}),a.Array.each(k,function(a){var b=h._mojits[a.proxy.getId()],c=a.proxy;b.handles=j(c._binder,c._node,c._element)}),d&&e&&(l=h._mojits[d],m=c[e],l&&m&&(l.children||(l.children={}),l.children[e]={type:m.type,viewId:e})),a.mojito.perf.mark("mojito","core_binders_resume"),h.resume(),a.mojito.perf.mark("mojito","core_binders_end"),n("post-attach-binders",{})},a.Object.each(c,function(d,e){if(h._mojits[e])return;if(!d.name){a.log("No binder for "+d.type+"."+d.action,"info",b),q();return}YUI._mojito.loader.load(d.needs,function(j){var l,m=d.type,n=d.base,o=d.name,p=d.instanceId,s,t,u,v,w,x;if(j){a.log("failed to load prerequisites for binder "+o,"error",b),q();return}a.use(d.name,function(j){l=a.mojito.util.copy(d.config),x=document.getElementById(e);if(!x){a.log('Did not find DOM node "'+e+'" for binder "'+o+'"',"warn",b),q();return}w=new a.Node(x),t=j.mojito.binders[o],v=a.mojito.util.heir(t),a.log('Created binder "'+o+'" for DOM node "'+e+'"',"info",b),d.children&&(u=i(d.children,c)),s=new a.mojito.MojitProxy({action:d.action,binder:v,base:n,node:w,element:x,viewId:e,instanceId:p,client:h,store:r,type:m,config:l,context:g}),h._state===f.PAUSED&&s._pause(),k.push({proxy:s,children:u}),a.Lang.isFunction(v.init)&&v.init(s),q()})})},this)},executeAction:function(c,d,e){var f=this;a.log('Executing "'+(c.instance.base||"@"+c.instance.type)+"/"+c.instance.action+'" on the client.',"mojito",b),this.resourceStore.expandInstanceForEnv("client",c.instance,this.context,function(b,g){var h=Boolean(g.controller);c.context=f.context,!h||c.rpc?f.tunnel.rpc(c,new a.mojito.OutputHandler(d,e,f)):f.dispatcher.dispatch(c,new a.mojito.OutputHandler(d,e,f))})},doRender:function(a,b,c,d){!a._views||!a._assetsRoot?this.resourceStore.getType("client",a.type,a.context,function(e,f){if(e){d(new Error("Failed to load mojit information for "+a.type));return}a._views=f.views,a._assetsRoot=f.assetsRoot,g(a,b,c,d)}):g(a,b,c,d)},doBroadcast:function(c,d,e,f){f=f||{};var g,h,i=f.target?this._mojits[d].children[f.target.slot]:null;if(f&&f.target)if(f.target.slot&&i){g=i.instanceId,a.Object.each(this._mojits,function(a,b){a.proxy._instanceId===g&&(h=b)});if(!h){a.log("No broadcast target found for "+f.target.slot+":"+g,"warn",b);return}}else f.target.viewId&&(h=f.target.viewId);this._listeners[c]&&a.Array.each(this._listeners[c],function(a){(!h||h===a.viewId)&&a.cb({data:e,source:d})})},doListen:function(a,b,c){this._listeners[a]||(this._listeners[a]=[]),this._listeners[a].push({guid:b,viewId:b,cb:c})},doUnlisten:function(a,b){function e(a,b){var c=0;while(c<a.length)a[c].viewId===b?a.splice(c,1):c+=1;return a}var c=this._listeners,d;if(b)e(c[b],a);else for(d in c)c.hasOwnProperty(d)&&e(c[d],a)},destroyMojitProxy:function(b,c){var d;this._mojits[b]&&(this._mojits[b].proxy._destroy(c),delete this._mojits[b],d=l(this._mojits,b),d&&d._binder.onChildDestroyed&&a.Lang.isFunction(d._binder.onChildDestroyed)&&d._binder.onChildDestroyed({id:b}))},pause:function(){if(this._state===f.PAUSED){a.log('Cannot "pause" the mojito client because it has already been paused.',"warn",b);return}this._state=f.PAUSED,a.Object.each(this._mojits,function(a){a.proxy._pause()}),a.log("Mojito Client state: "+this._state+".","info",b)},resume:function(){if(this._state!==f.PAUSED){a.log('Cannot "resume" the mojito client because it was never paused.',"warn",b);return}this._state=f.ACTIVE,a.Object.each(this._mojits,function(a){a.proxy._resume()}),a.Array.each(this._pauseQueue,function(a){var b=a.fn,c=a.args;b.apply(this,c)},this),this._pauseQueue=[],a.log("Mojito Client state: "+this._state+".","info",b)},refreshMojitView:function(c,d,e){var f=this;c.invoke(c._action,d,function(d,g,i){if(d)throw new Error(d);var j={},k,l,m={},n,o,p;p=function(a,b,c){var d,e,g,h;if(!b||!a)return;for(h in b)b.hasOwnProperty(h)&&(d=b[h],a&&a[h]&&(e=a[h].proxy),e&&(g=i.binders[d.viewId].config.children,c[d.viewId]=e.getId(),g&&p(f.mojits[e.getId()].children,g,c)))};for(n in f._mojits)if(f._mojits.hasOwnProperty(n)){o=f._mojits[n];for(k in i.binders)i.binders.hasOwnProperty(k)&&(l=i.binders[k],l.instanceId===o.proxy._instanceId&&(a.log("matched instanceId "+l.instanceId,"debug",b),j[k]=n,p(f._mojits[o.proxy.getId()].children,l.children,j)))}a.Object.each(j,function(a,b){var c=new RegExp(b,"g");g=g.replace(c,a)}),h(g,c),a.Object.each(i.children,function(b,d){var e=j[b.viewId],g=f._mojits[e],h,k,l,n;if(!g){m[b.viewId]=i.binders[b.viewId];return}h=f._mojits[e].proxy,k=c._node.one("#"+e),l=k._node,n=h._binder,h._node=k,h._element=l,a.Lang.isFunction(n.onRefreshView)?n.onRefreshView(k,l):a.Lang.isFunction(n.bind)&&n.bind(k,l)}),f.attachBinders(m),e&&e(g,i)})}},a.mojito.Client=m},"0.1.0",{requires:["io-base","event-delegate","node-base","querystring-stringify-simple","mojito","mojito-logger","mojito-loader","mojito-dispatcher","mojito-route-maker","mojito-client-store","mojito-resource-store-adapter","mojito-mojit-proxy","mojito-tunnel-client","mojito-output-handler","mojito-util"]}),YUI.add("mojito-test",function(a,b){function c(){var b=YUITest.Mock();return b.expect=function(){return a.Array.each(arguments,function(a){YUITest.Mock.expect(b,a)}),b},b.verify=function(){YUITest.Mock.verify(b)},b}function d(a,b){a._addons.push(b),a[b]=new c}function e(a,b){a.models[b]=new c}function f(a,b,d){var e=new c;a[b]||(a[b]={}),a._extras[b]||(a._extras[b]={}),a._extras[b][d]=e,a[b][d]=e}function g(b){var c=YUITest.Mock();return b=b||{},c._addons=[],c.models={},c._extras={},b.addons&&a.Array.each(b.addons,function(a){d(c,a)}),b.models&&a.Array.each(b.models,function(a){e(c,a)}),b.extras&&a.Object.each(b.extras,function(b,d){a.Lang.isArray(b)?a.Array.each(b,function(a){f(c,d,a)}):f(c,d,b)}),c.expect=function(){return a.Array.each(arguments,function(a){YUITest.Mock.expect(c,a)}),c},c.verify=function(){var a,b,d;YUITest.Mock.verify(c);for(a=0;a<c._addons.length;a+=1)d=c[c._addons[a]],d.verify();for(a in c.models)c.models.hasOwnProperty(a)&&c.models[a].verify();for(a in c._extras)if(c._extras.hasOwnProperty(a))for(b in c._extras[a])c._extras[a].hasOwnProperty(b)&&c._extras[a][b].verify()},c}a.mojito.MockActionContext=g,a.mojito.EasyMock=c},"0.1.0",{requires:["mojito"]}),YUI.add("mojito",function(a,b){a.namespace("mojito"),a.mojito.version="0.2",a.namespace("mojito.trans"),a.namespace("mojito.actions"),a.namespace("mojito.binders"),a.namespace("mojito.controllers"),a.namespace("mojito.models"),a.namespace("mojito.addons"),a.namespace("mojito.addons.ac"),a.namespace("mojito.addons.viewEngines")},"0.1.0",{requires:["mojito-perf"]}),YUI.add("mojito-output-handler",function(a,b){function f(a,b,c){this.viewId=a,this.callback=b,this.buffer="",this.mojitoClient=c}var c,d,e={js:{},css:{}};c=function(b,c){var d={css:[],js:[]},f={},g="",h;a.Object.each(b,function(b,c){a.Object.each(b,function(a,b){var c;if(b==="blob")for(c=0;c<a.length;c+=1)g+=a[c];else for(c=0;c<a.length;c+=1)e[b][a[c]]||d[b].push(a[c]),e[b][a[c]]=!0})}),g&&a.one("head").append(g),h=function(a){a&&(f[a]=!0),f.css&&f.js&&c()},d.css.length>0?a.Get.css(d.css,{onEnd:function(){h("css")}}):f.css=!0,d.js.length>0?a.Get.script(d.js,{onEnd:function(){h("js")}}):f.js=!0,h()},d=function(b,c,d,e,f){c.http.headers["content-type"]&&c.http.headers["content-type"][0].indexOf("application/json")===0&&(b=a.JSON.parse(b)),f(null,b,c),c&&c.binders&&window.setTimeout(function(){d.attachBinders(c.binders,e,c.view.id)})},f.prototype={flush:function(a,b){this.done(a,b)},done:function(a,b){var e=this.mojitoClient,f=this.viewId,g=this.callback;b&&b.assets?c(b.assets,function(){d(a,b,e,f,g)}):d(a,b,e,f,g)},error:function(a){this.callback(a)}},a.mojito.OutputHandler=f},"0.1.0",{requires:["mojito","json"]}),YUI.add("mojito-perf",function(a,b){function e(d,e){a.log(d+":"+e+" "+(c[d][e].time-c.mojito.core.time)+"ms","mojito",b)}YUI._mojito||(YUI._mojito={}),YUI._mojito._perf||(YUI._mojito._perf={},YUI._mojito._perf.mojito={},YUI._mojito._perf.mojito.core={},YUI._mojito._perf.mojito.core.msg="Framework start time",YUI._mojito._perf.mojito.core.time=typeof MOJITO_INIT!="undefined"?MOJITO_INIT:(new Date).getTime());var c=YUI._mojito._perf,d=!1;a.namespace("mojito").perf={mark:function(a,b,f){if(!d)return;if(!a||!b)return;c[a]||(c[a]={}),f||(f=""),c[a][b]={},c[a][b].msg=f,c[a][b].time=(new Date).getTime(),e(a,b)},dump:function(){var a,b;for(a in c)if(c.hasOwnProperty(a))for(b in c[a])c[a].hasOwnProperty(b)&&e(a,b)}}}),YUI.add("mojito-resource-store-adapter",function(a,b){var c="",d;a.mojito.ResourceStoreAdapter={ENV:"",init:function(a,e,f){return d=f,d.log("resource store adapter init","mojito",b),c=e._root,this.ENV=a,this.store=e,this._root=e._root,this._staticURLs=e._staticURLs,this},expandInstance:function(a,b,c){return this.expandInstanceForEnv(this.ENV,a,b,c)},expandInstanceForEnv:function(b,c,d,e){var f={},g={},h=this;c.instanceId||(c.instanceId=a.guid()),c.guid=c.instanceId;if(c.base)g.name=c.base,g.func=this.getSpec;else{if(!c.type)throw new Error('There was no info in the "instance" object');g.name=c.type,g.func=this.getType}h.getApp(b,d,function(a){g.func(b,g.name,d,function(g,i){if(g){e(g);return}f=h.merge(a,i,c);if(!h.validate(f)){e({message:"Instance was not valid.",stack:JSON.stringify(f,null,4)});return}h.cache(b,c,d,f),e(null,f)},h)})},getApp:function(a,b,c){var d={};c(d)},getAppPath:function(){return c},getAppConfig:function(a,b){return this.store.getAppConfig(a,b)},getSpec:function(a,b,c,d,e){e||(e=this),e.store.getSpec(a,b,c,d)},getType:function(a,b,c,d,e){e||(e=this),e.store.getType(a,b,c,d)},merge:function(){var b={},c;for(c=0;c<arguments.length;c+=1)b=a.mojito.util.mergeRecursive(b,arguments[c]);return b},validate:function(a){return!a.type||!a.yui?!1:!0},isCached:function(a,b,c){return!1},getCached:function(a,b,c){return{}},cache:function(a,b,c,d){return!1},getYuiConfigAllMojits:function(a,b){return this.store.getYuiConfigAllMojits(a,b)},getYuiConfigApp:function(a,b){return this.store.getYuiConfigApp(a,b)},getYuiConfigFw:function(a,b){return this.store.getYuiConfigFw(a,b)},serializeClientStore:function(a,b){return this.store.serializeClientStore(a,b)},getMojitTypeDetails:function(a,b,c,d){return this.store.getMojitTypeDetails(a,b,c,d)},fileFromStaticHandlerURL:function(a){return this.store.fileFromStaticHandlerURL(a)},getRoutes:function(a){return this.store.getRoutes(a)}}},"0.1.0",{requires:["mojito-util"]}),YUI.add("mojito-rest-lib",function(a,b){function c(a){this._resp=a}a.namespace("mojito.lib"),c.prototype={getStatusCode:function(){return this._resp.status},getStatusMessage:function(){return this._resp.statusText},getHeader:function(){return this._resp.getResponseHeader.apply(this._resp,arguments)},getHeaders:function(){return this._resp.getAllResponseHeaders()},getBody:function(){return this._resp.responseText}},a.mojito.lib.REST={_doRequest:function(b,d,e,f,g){var h={method:b,data:e,on:{}};f&&(h.headers=f.headers,h.timeout=f.timeout),g&&(h.on.success=function(a,b){var d=new c(b);g(null,d)},h.on.failure=function(a,b){g(b)}),a.io(d,h)},GET:function(){var a=["GET"].concat(Array.prototype.slice.call(arguments));this._doRequest.apply(this,a)},POST:function(){var a=["POST"].concat(Array.prototype.slice.call(arguments));this._doRequest.apply(this,a)},PUT:function(){var a=["PUT"].concat(Array.prototype.slice.call(arguments));this._doRequest.apply(this,a)},DELETE:function(){var a=["DELETE"].concat(Array.prototype.slice.call(arguments));this._doRequest.apply(this,a)},HEAD:function(){var a=["HEAD"].concat(Array.prototype.slice.call(arguments));this._doRequest.apply(this,a)}}},"0.1.0",{requires:["io","mojito"]}),YUI.add("mojito-route-maker",function(a,b){function e(a){if(a.indexOf("{")===0)return a.substring(1,a.length-1)}function f(b,c){var d=[];if(a.Object.size(b.requires)===0)return b;a.Object.each(c,function(a,c){b.requires&&b.requires[c]&&d.push(c+"="+a)});if(d.length){d.sort();if((new RegExp(b.int_match)).test(d.join("&")))return a.Object.each(c,function(a,c){b.query[c]=a}),b}}function g(b,c){var d,e,f,g,h,i,j;c.name||(c.name=b),c.verbs||(c.verbs=["GET"]);if(c.verbs.length&&c.path&&c.call){c.params||(c.params=""),c.regex||(c.regex={}),c.query||(c.query={}),e={};for(d in c.verbs)c.verbs.hasOwnProperty(d)&&(e[c.verbs[d].toUpperCase()]=!0);c.verbs=e,f=c.path.split("/");for(i in f)f.hasOwnProperty(i)&&(f[i][0]===":"&&(j=f[i].substr(1),c.query[j]="",f[i]=c.regex[j]?"("+c.regex[j]+")":"([^/]+)"),f[i][0]==="*"&&(f[i]="(.*)"));c.requires={},g=c.path.match(/:([^\/]+)/g);for(d in g)g.hasOwnProperty(d)&&(c.requires[g[d].substr(1)]="[^&]+");for(d in c.regex)c.regex.hasOwnProperty(d)&&(c.requires[d]=c.regex[d]);c.params=a.QueryString.parse(c.params),h=[];for(d in c.requires)c.requires.hasOwnProperty(d)&&h.push(d+"="+c.requires[d]);h.sort(),c.ext_match="^"+f.join("/")+"$",c.int_match="^"+h.join("&")+"$"}return c}function h(a){var b;this._routes={};for(b in a)a.hasOwnProperty(b)&&(this._routes[b]=g(b,a[b]))}var c,d;c=function(a,b){var c=b.substr(1).split("/"),d=a.path.substr(1).split("/"),e={},f=0;return d.forEach(function(b){var d,g,h;b.indexOf(":")===0&&(d=b.substr(1),g=c[f],e[d]=g,h=new RegExp("{"+d+"}","g"),h.test(a.call)?a.call=a.call.replace(h,e[d]):a.params[d]=g),f+=1}),a},d=function(a){var b=null,c="";if(!a||typeof a!="object")return a;b=new a.constructor;for(c in a)a.hasOwnProperty(c)&&(b[c]=d(a[c]));return b},h.prototype={make:function(b,c){var d=b.split("?"),e=d[0],f={},g,h;c=c||"GET",d[1]&&(f=a.QueryString.parse(d[1])),g=this._matchToExternal(e,f,c,this._routes);if(!g)throw new Error("No route match found for '"+b+"' ("+c+")");return h=g.path,a.Object.each(g.query,function(a,b){h=h.replace(":"+b,a),delete f[b]}),a.Object.isEmpty(f)||(h+="?"+a.QueryString.stringify(f)),h},find:function(a,b){var c,e,f,g,h;b=b||"GET",c=this._matchToInternal(a,b,this._routes);if(!c)return null;e=d(c),f=(new RegExp(c.ext_match)).exec(a),g=1;for(h in e.query)e.query.hasOwnProperty(h)&&(e.query[h]=f[g],g+=1);for(g in e.params)e.params.hasOwnProperty(g)&&!e.query[g]&&(e.query[g]=e.params[g]);return e},getComputedRoutes:function(){return this._routes},_matchToInternal:function(a,b,d){var e;b||(b="GET"),b=b.toUpperCase();for(e in d)if(d.hasOwnProperty(e)&&(new RegExp(d[e].ext_match)).test(a)&&d[e].verbs&&d[e].verbs.hasOwnProperty(b))return c(d[e],a);return!1},_matchToExternal:function(b,c,d,g){var h,i=b.split("."),j=i[0],k=i[1];return a.Object.some(g,function(a){var g,i,l,m,n;if(b===a.call&&a.verbs[d]){h=f(a,c);if(h)return!0}if("*.*"===a.call&&a.verbs[d]){c.module=j,c.action=k,h=f(a,c);if(h)return!0}g=a.call.split("."),i=g[0],l=g[1],m=e(i),m&&(c[m]=j),n=e(l),n&&(c[n]=k);if((n||k===l)&&(m||j===i)&&a.verbs[d]){h=f(a,c);if(h)return!0}}),h}},a.mojito.RouteMaker=h},"0.1.0",{requires:["querystring-stringify-simple","querystring-parse","mojito-util"]}),YUI.add("mojito-client-store",function(a,b){function j(b){this.appConfig=b.appConfig,this.routes=b.routes,this.appConfig.pathToRoot=b.pathToRoot,this.staticPrefix="/static",this.appConfig&&this.appConfig.staticHandling&&this.appConfig.staticHandling.hasOwnProperty("prefix")&&(this.staticPrefix=this.appConfig.staticHandling.prefix?"/"+this.appConfig.staticHandling.prefix:""),typeof window!="undefined"&&(this.staticPrefix=a.mojito.util.iOSUrl(this.staticPrefix)+"/"),this.staticPrefix=i(this.staticPrefix)}var c,d={},e,f,g,h,i;YUI._mojito||(YUI._mojito={}),YUI._mojito._cache||(YUI._mojito._cache={}),YUI._mojito._cache.store||(YUI._mojito._cache.store={}),c=YUI._mojito._cache.store,e=function(a,b){d[a]||(d[a]=[]),d[a].push(b)},f=function(a,b,c){var e,f;if(d[a]){f=d[a].splice(0,d[a].length),delete d[a];for(e=0;e<f.length;e+=1)f[e](b,c)}},g=function(b,g){var h=function(a,d){c[b]={};try{c[b]=JSON.parse(d.responseText)}catch(e){f(b,e);return}f(b,null,c[b])};if(c[b]){g(null,c[b]);return}d[b]||a.io(b,{headers:{"x-mojito-header":"tunnel"},on:{complete:h}}),e(b,g)},h=function(a,b){return YUI._mojito._cache.compiled&&YUI._mojito._cache.compiled[a]&&YUI._mojito._cache.compiled[a].specs&&YUI._mojito._cache.compiled[a].specs[b]},i=function(a){return"/"===a.charAt(a.length-1)?a.substring(0,a.length-1):a},j.prototype={getSpec:function(b,d,e,f){var i=d.split(":"),j=i[0],k=i[1]||"default",l=j.replace(/\./g,"_"),m;m=this.staticPrefix+"/"+j+"/specs/"+k+".json",m+="?"+a.QueryString.stringify(e),this.appConfig.pathToRoot&&(m=this.appConfig.pathToRoot+m);if(h(l,k)){c[m]=YUI._mojito._cache.compiled[l].specs[k],f(null,c[m]);return}g(m,f)},getType:function(b,c,d,e){var f=this.staticPrefix+"/"+c+"/definition.json";f+="?"+a.QueryString.stringify(d),this.appConfig.pathToRoot&&(f=this.appConfig.pathToRoot+f),g(f,e)},getAppConfig:function(a,b){return this.appConfig},getRoutes:function(){return this.routes}},a.mojito.ResourceStore=j},"0.1.0",{requires:["mojito-util","querystring-stringify-simple"]}),YUI.add("dali-bean",function(a){function b(c){b.superclass.constructor.call(this,{bubbles:!0,emitFacade:!0}),a.mix(this,c),a.Do.before(function(a){this.publish(a.type||a)},this,"fire")}a.extend(b,a.EventTarget),a.namespace("Dali"),a.Dali.Bean=b},"1.6.3",{requires:["breg","oop","event-custom"]}),YUI.add("bean-performance-watcher",function(a){var b="Bean Performance Monitor",c=a.Dali.beanRegistry,d="rstart",e="rdone",f="reinits",g="reinitd",h="initd",i="injd",j={},k;k=function(){function a(a){var b=a.type.split(":")[1],c=(new Date).getTime();b===f?(j[b]={},j[b][a.bean]=c):j[b]=c,b===g&&delete j[f][a.bean]}function b(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&(b+=1);return b}function k(){var a=j[i]-j[d],f=j[e]-j[d],g=j[h]-j[e],k=j[i]-j[h],l;j.total=a,l=b(c.getBeans())}return a({type:"blah:"+d}),c.on(e,a),c.on(h,a),c.on(i,a),c.on(f,a),c.on(g,a),c.on(i,k),{getTime:function(a){return j[a]},destroy:function(){c.detach()}}},k.NAME=b,a.namespace("Dali.beans"),a.Dali.beans.PerformanceMonitor=k},"1.6.3",{requires:["breg"]}),YUI.add("breg",function(a){function p(a,b,c,d){var e;c.getAttrs&&c.getAttrs().hasOwnProperty(b)?(c.set(b,a),n+=1):(e=c["set"+b.substr(0,1).toUpperCase()+b.substr(1)],e&&i(e)&&(e.call(c,a),n+=1))}function q(a,b,c){var d;if(a.inject===!1)return;for(d in c)c.hasOwnProperty(d)&&p(a,b,c[d],d)}function r(a,b,c){var d;for(d in c)c.hasOwnProperty(d)&&p(c[d],d,a,b)}var b="beanRegistry",c="rstart",d="rdone",e="reinits",f="reinitd",g="initd",h="injd",i=a.Lang.isFunction,j=!1,k=!1,l={},m={},n=0,o;o=function(){o.superclass.constructor.apply(this,arguments)},o.NAME=b,a.extend(o,a.EventTarget,{_instantiateBeans:function(){var a;this.fire(d);for(a in l)l.hasOwnProperty(a)&&(i(l[a])?m[a]=new l[a]:m[a]=l[a]);j=!0,this.fire(g)},_getNumberOfInjections:function(){return n},initializer:function(){this.fire(c)},registerBean:function(a,b){l[a]=b,k&&this.reInitializeBean(a)},getBeans:function(){return m},getBean:function(a){return m[a]},getName:function(a){var b;for(b in m)if(m.hasOwnProperty(b)&&a===m[b])return b},reInitializeBean:function(a){var b=!1,c,d,g=m[a];this.fire(e,{bean:a}),g&&g.destroy&&i(g.destroy)&&(b=g.destroy()||!1);if(b)for(c in g)g.hasOwnProperty(c)&&g[c]instanceof Function&&c.substr(0,3)==="set"&&(d=c.substr(3,1).toLowerCase()+c.substr(4),m[d]&&this.reInitializeBean(d));delete m[a],m[a]=i(l[a])?new l[a]:l[a],r(m[a],a,m),q(m[a],a,m),this.fire(f,{bean:a})},doInjection:function(){var a,b,c;k||(this._instantiateBeans(),c=h);for(a in m)m.hasOwnProperty(a)&&(b=m[a],q(b,a,m));this.fire(c),k=!0},clear:function(){var a,b;for(a in m)m.hasOwnProperty(a)&&(b=m[a],b.destroy&&i(b.destroy)&&b.destroy(),delete m[a],delete l[a]);k=!1,j=!1,n=0}}),a.namespace("Dali"),a.Dali.beanRegistry=new o},"1.6.3",{requires:["oop","event-custom"]}),YUI.add("io-facade",function(a){function n(a){i[a]=new Date}var b="ioFacade",c=a.Lang,d=c.isUndefined,e="GET",f="post",g=15e3,h=null,i={},j={},k,l,m;m=function(){var c={setTransportUtils:function(a){l=a},setConfigProvider:function(a){k=a},execute:function(b,c,d,f,i){var m,o,p;return j[b]=i,d.txid=b,h||(h=k.getProxyTimeout()||g),c=f===e?l.formatUrl(c,"&__r="+(new Date).getTime()):c,m={method:f,data:d,on:{success:this.handleResponse,failure:this.handleResponse,start:n,scope:this},context:this,timeout:h,headers:{"Content-Type":"application/json"}},p=a.io(c,m),p},_simulateResponse:function(a,b,c){b.getResponseHeader=function(){return""},c?this.handleResponse(a,b,!0):this.handleResponse(a,b,!1)},handleResponse:function(c,d,e){var f=new Date-i[c],g=a.JSON.parse(d.responseText),h=g.resps[0].txId,k=j[h];delete j[h],this.fire("transactionResponse",{type:"transactionResponse",id:c,resp:d,responseData:g,badcookie:e,cb:k,time:f},b)}};return new a.Dali.Bean(c)},m.NAME=b,a.Dali.beanRegistry.registerBean(b,m)},"1.6.3",{requires:["breg","dali-bean"]}),YUI.add("simple-request-formatter",function(a){var b="reqFormatter",c=a.Lang,d=c.isString,e=c.isUndefined,f="POST",g="GET",h="cfg.dali.handler.ws",i,j,k,l,m={};l=function(a){var b=h,c=a.batchable||!1,l=!1,m;e(a.method)&&(a.method=g);switch(a.method.toUpperCase()){case f:l=!0,m=a.data,d(m)?a.data=m:i.error(k.NAME,"data must be a string");break;case g||"DELETE":a.data!==undefined&&d(a.data)&&(a.url=j.formatUrl(a.url,a.data));break;default:}return{handler:b,data:a,batchable:c,forcepost:l,targetId:a.url}},k=function(){return{setErrorReporter:function(a){i=a},setTransportUtils:function(a){j=a},replaceRequestFormatter:function(a,b){m[a]=b},formatRequest:function(a,b){var c=b.requestObject;return c=l(c,b.moduleId),c.txId=a,e(b.targetId)&&(b.targetId=c.targetId),c.handler=h,c}}},k.NAME=b,a.Dali.beanRegistry.registerBean(b,k)},"1.6.3",{requires:["breg"]}),YUI.add("request-handler",function(a){function I(a){F.error(k,'"'+b+'" does not support operation: '+a)}function J(a,c,d){var e,f={requestObject:a,moduleId:d,originId:d};a.moduleId&&(f.targetId=a.moduleId),this.fire(m,{type:m,request:f.requestObject,originId:f.originId},b),e=A.formatRequest(x+=1,f),y.doRequest({request:e,callback:c,immediate:!0,forcepost:a.forcepost})}function K(d){var e=d.response||{},f=d.method,g=d.result,h=d.cb,i=d.resultDetail,j=null,k=null,m,p,q,u,v,w;e.result=g||c,e.resultDetail=i||"",this.fire(n,{type:n,response:e},b),s(e.data)&&(k=e.data.res,j=e.data.mods);if(s(j)){j[0].state&&j[0].state.defer&&(e.status=504,e.statusText=l,f=o);for(p=0,w=j.length;p<w;p)j[p].props&&j[p].props.id&&z.registerModule(j[p])}e=D.createResponseObject(e),h=e.cb||h,t(h.argument)||(e.argument=h.argument,m=h.argument),r(h[f])&&(q=a.bind(h[f],h.scope||this,e,m),u=a.bind(h[o],h.scope||this,e,m),s(k)?(v=B.getService("resourcemgr"),v.load(k,{success:q,failure:u},G.getProxyTimeout())):q())}function L(a){var b=a.badcookie||!1,f=a.resp,g=a.responseData,h=a.cb,k=a.id,l=f.status,m="",n=p,q,r;if(l!==200&&l!==201&&l!==c)l===0?n=f.statusText===e?e:d:(m=i,F.error(i,"A server error occurred: ",{responseObject:f})),K.call(this,{txId:k,method:o,result:n,resultDetail:m+" "+l,cb:h});else{q=f.responseText,r=f.getResponseHeader("Content-Type");if(r.indexOf("Multipart/Related")!==-1){I("multi-part response"),K.call(this,{cb:h,method:o,result:p,resultDetail:j});return}D.processResponse(g.resps[0],{cb:h},b)}}var b="requestHandler",c="ok",d="abort",e="timeout",f=2,g=1,h=0,i="server",j="badformat",k="unsupported",l="Gateway Timeout",m="request",n="response",o="failure",p="error",q=a.Lang,r=q.isFunction,s=q.isObject,t=q.isUndefined,u=q.isNull,v=h,w=null,x=0,y,z,A,B,C,D,E,F,G,H;H=function(){var b={setRequestor:function(a){y=a},setModulePlatform:function(a){z=a},setReqFormatter:function(a){A=a},getRequestFormatter:function(){return A},setServiceRegistry:function(a){B=a},setRegistrationProvider:function(a){C=a},setResponseProcessor:function(a){D&&D.detach(),D=a,D.on("responseProcessed",K,this)},getResponseProcessor:function(){return D},setIoFacade:function(a){E&&E.detach(),E=a,E.on("transactionResponse",L,this)},getIoFacade:function(){return E},setConfigProvider:function(a){G=a},getConfigProvider:function(){return G},setErrorReporter:function(a){F=a},replaceRequestFormatter:function(a,b){A.replaceRequestFormatter(a,b)},replaceResponseFormatter:function(a){D.replaceResponseFormatter(a)},disable:function(a){v=a?f:g},enable:function(a){v=h},isEnabled:function(){return v!==g},processRequest:J,abortRequest:function(a,b){I("abortRequest")},abortModuleRequests:function(a){I("abortModuleRequests")},isRequestPending:function(a,b){I("isRequestPending")}};return new a.Dali.Bean(b)},H.NAME=b,a.Dali.beanRegistry.registerBean(b,H)},"1.6.3",{requires:["dali-bean","breg"]}),YUI.add("requestor",function(a){function m(b){var f=l.getProxyUrl(),m=b.request,n=b.callback,o=b.forcepost,p=b.immediate,q,r,s;typeof o=="undefined"&&(o=!1),typeof p=="undefined"&&(p=!1),g(i)&&(i={},i.dali=l.getDaliProperties()||{}),h(m)?s=d:(s=m.method||d,m=[m]),r=a.JSON.stringify({reqs:m,props:i});if(encodeURIComponent(r).length>e||o)s=c;if(!p)return q=k.execute(m[0].txId,f,r,s),j[q.id]={ioObj:q,cfg:m,forcepost:o},q;k.execute(m[0].txId,f,r,s,n)}function n(){return{setIoFacade:function(a){k=a},setConfigProvider:function(a){l=a},setDaliCrumb:function(a){i.dali.crumb=a},deletePending:function(a){delete j[a]},getPending:function(a){return j[a]},doRequest:m}}var b="requestor",c="POST",d="GET",e=1500,f=a.Lang,g=f.isNull,h=f.isArray,i=null,j={},k,l;n.NAME=b,a.Dali.beanRegistry.registerBean(b,n)},"1.6.3",{requires:["json","breg"]}),YUI.add("response-formatter",function(a){function c(a){return a}function d(){return{formatResponse:c,replaceResponseFormatter:function(a){this.formatResponse=a}}}var b="respFormatter";d.NAME=b,a.Dali.beanRegistry.registerBean(b,d)},"1.6.3",{requires:["breg"]}),YUI.add("response-processor",function(a){function o(b){var c=a.Object(b.data),d=!1,e=!1;return c.getResponseHeader=function(a){var b,f,g,h;if(!d){this.responseHeader=c.responseHeader.replace("\r\n","\n"),e=!0,b=c.responseHeader.split("\n"),f=b.length,d={};for(g=0;g<f;g+=1)h=b[g].split(": "),d[h[0]]=h[1]}return d[a]},c.getAllResponseHeaders=function(){return e||(this.responseHeader=c.responseHeader.replace("\r\n","\n")),this.responseHeader},a.mix(b,c)}var b="responseProcessor",c="ok",d=a.Lang,e=d.isUndefined,f="error",g="browser",h="crumb",i="nocookies",j="badcrumb",k,l,m,n;n=function(){var d={setConfigProvider:function(a){m=a},setRespFormatter:function(a){k=a},setErrorReporter:function(a){l=a},replaceResponseFormatter:function(a){k.replaceResponseFormatter(a)},processResponse:function(a,d,k){var m=a.txId,n=!0,o,p,q,r,s;if(e(d))return;o={data:a.data},o.cb=d.cb;if(a.status===200||a.status===201)o.status=c,o.result=c,p=c,n=!1;else{o.status=f,o.result=f;if(a.status===400){r=h,s="Invalid crumb.",q=j,p=f;if(!window.navigator.cookieEnabled||k==="badcookie")r=g,q=i,s="Cookies are disabled";l.error(r,s)}}this.fire("responseProcessed",{type:"responseProcessed",txId:m,response:o,method:n?"failure":"success",result:p,resultDetail:q},b)},createResponseObject:function(a,b){return a.data&&a.data.responseText?o(a):(a.data&&(a.data.mods&&(a.mods=a.data.mods,a.mod=a.mods[0],delete a.data.mods),a.data.html&&(a.html=a.data.html,delete a.data.html),a.data.res&&(a.res=a.data.res,delete a.data.res)),a=k.formatResponse(a),a)}};return new a.Dali.Bean(d)},n.NAME=b,a.Dali.beanRegistry.registerBean(b,n)},"1.6.3",{requires:["dali-bean","breg"]}),YUI.add("dali-transport-base",function(a){var b="transport",c=a.Lang,d=c.isArray,e="injd",f,g;g=function(){var c={name:b,setRequestHandler:function(a){f&&(f.removeTarget(this),f.detach()),f=a,f.addTarget(this)},getRequestHandler:function(){return f},disable:function(a){f.disable(a)},enable:function(){f.enable()},isEnabled:function(){return f.isEnabled()},makeRequest:function(a,b,c){var e,g;if(f.isEnabled()){if(d(a)&&a.length>1){for(e=0,g=a.length;e<g;e+=1)a[e].batchable===undefined&&(a[e].batchable=!0),f.processRequest(a[e],b,c);return null}return f.processRequest(d(a)?a[0]:a,b,c)}return!1},getMetrics:function(a){return f.getMetrics(a)},clearMetrics:function(a){f.clearMetrics(a)},abortRequest:function(a,b){return f.abortRequest(a,b)},abortModuleRequests:function(a){return f.abortModuleRequests(a)},isRequestPending:function(a,b){return f.isRequestPending(a,b)},setRequestFormatter:function(a,b){f.replaceRequestFormatter(a,b)},setResponseFormatter:function(a){f.replaceResponseFormatter(a)},destroy:function(){return!0}};return a.Dali.beanRegistry.on(e,function(){!a.Dali&&!a.Dali.Platform&&(a.namespace("Dali"),a.Dali.transport=new g)}),new a.Dali.Bean(c)},g.NAME=b,a.Dali.beanRegistry.registerBean(b,g)},"1.6.3",{requires:["event-custom","breg","dali-bean"]}),YUI.add("transport-utils",function(a){function c(){return{formatUrl:function(a,b){return a+(a.indexOf("?")===-1?"?":"&")+b}}}var b="transportUtils";c.NAME=b,a.Dali.beanRegistry.registerBean(b,c)},"1.6.3",{requires:["breg"]}),YUI.add("mojito-tunnel-client",function(a,b){function c(b){this._appConfig=b;var c={error:function(a,b){throw new Error("TRANSPORT ERROR: "+a+" : "+b)}},d={getProxyUrl:function(){return b.tunnelPrefix},getDaliProperties:function(){return{}},getProxyTimeout:function(){return 1e4}};a.Dali.beanRegistry.registerBean("errorReporter",c),a.Dali.beanRegistry.registerBean("configProvider",d),a.Dali.beanRegistry.doInjection(),this._transport=a.Dali.beanRegistry.getBean("transport")}c.prototype={rpc:function(c,d){c.forcepost=!0,this._transport.makeRequest(c,{success:function(c){a.log("rpc success","debug",b),d.done(c.html,c.data.meta)},failure:function(){a.log("rpc failure!","warn",b),a.log(arguments,"warn",b)}})}},a.mojito.TunnelClient=c},"0.1.0",{requires:["breg","querystring-stringify-simple","mojito","dali-transport-base","request-handler","simple-request-formatter","requestor","io-facade","response-formatter","response-processor"]}),YUI.add("mojito-util",function(a){function e(a,b){var c=a.length,d=b.toLowerCase();c-=1;while(c>=0){if(a[c].toLowerCase()===d)return!0;c-=1}return!1}function f(a){return e(b,a)}function g(a){return e(c,a)}function h(a){return e(d,a)}var b=["content-type"],c=["view"],d=["content-type"];a.mojito.util={array:{remove:function(a,b,c){var d=a.slice((c||b)+1||a.length);return a.length=b<0?a.length+b:b,this.push.apply(a,d)},contains:function(a,b){var c=a.length;c-=1;while(c>=0){if(a[c]===b)return!0;c-=1}return!1}},copy:function(b){var c=null,d="";if(!b||typeof b!="object")return b;c=new b.constructor;for(d in b)b.hasOwnProperty(d)&&(c[d]=a.mojito.util.copy(b[d]));return c},heir:function(a){function b(){}return b.prototype=a,new b},metaMerge:function(b,c,d,e){var i,j,k,l=e;for(i in c)if(c.hasOwnProperty(i))if(l||!g(i)){k=c[i],j=b[i];if(!j)b[i]=k;else if(a.Lang.isArray(k)){if(!a.Lang.isArray(j))throw new Error("Meta merge error. Type mismatch between mojit metas.");f(i)?h(i)?b[i]=[k[k.length-1]]:b[i]=k:j.push.apply(j,k)}else if(a.Lang.isObject(k))if(a.Lang.isObject(j))b[i]=a.mojito.util.metaMerge(j,k,d,!0);else{if(!a.Lang.isNull(j)&&!a.Lang.isUndefined(j))throw new Error("Meta merge error. Type mismatch between mojit metas.");b[i]=k}else d&&(b[i]=k)}return b},mergeRecursive:function(a,b,c){var d;for(d in b)b.hasOwnProperty(d)&&(b[d]&&b[d].constructor===Object?(a[d]||(a[d]={}),a[d]=this.mergeRecursive(a[d],b[d])):a[d]&&c?typeof a[d]==typeof b[d]&&(a[d]=b[d]):typeof b[d]!="undefined"&&(b[d]===null?typeof a[d]=="undefined"&&(a[d]=b[d]):a[d]=b[d]));return a},iOSUrl:function(a){return typeof window=="undefined"?a:(window.location.href.indexOf("file://")===0&&window.location.href.indexOf("/Applications/")>0&&window.location.href.indexOf(".app/")>0&&a.charAt(0)==="/"&&(a=a.slice(1)),a)}}},"0.1.0",{requires:["mojito"]}),YUI.add("mojito-view-renderer",function(a){function b(b,c){b=b||"mu",this._renderer=new a.mojito.addons.viewEngines[b](c)}b.prototype={render:function(a,b,c,d,e,f){this._renderer.render(a,b,c,d,e,f)}},a.mojito.ViewRenderer=b},"0.1.0",{requires:["mojito"]})